<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <title>Campaign - adsXenium</title>
</head>

<body>
    <div>
        <nav class="navbar navbar-expand-lg sticky-top navbar-dark bg-dark shadow">
            <a class="navbar-brand" href="/">adsXenium</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup"
                aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                <div class="navbar-nav ml-auto">
                    <a class="nav-item nav-link btn btn-dark" href="/advertiser/1">Advertiser</a>
                    <a class="nav-item nav-link btn btn-dark active" href="/campaign">Campaign</a>
                    <a class="nav-item nav-link btn btn-outline-danger" href="/logout">Logout</a>
                </div>
            </div>
        </nav>
        <div class="container row mx-auto">
            <div class="form-row align-items-center mx-auto">
                <div class="col-sm-2 my-1">
                    <select class="custom-select mr-sm-2" name="advertiserName" id="Advertiser">
                        <option value="null" selected>Advertiser</option>
                        <% for(let i = 0; i < campaignData.length; i++) {  if(campaignData[i].advertiserName != undefined)%>
                        <option value="<%= campaignData[i].advertiserName %>"> <%= campaignData[i].advertiserName %>
                        </option>
                        <% } %>
                    </select>
                </div>
                <div class="col-sm-2 my-1">
                    <select class="custom-select mr-sm-2" name="campaignName" id="campaign">
                        <option value="null" selected>Campaign Name</option>
                        <% for(let i = 0; i < campaignData.length; i++) { if(campaignData[i].campaignName != undefined)%>
                        <option value="<%= campaignData[i].campaignName %>"> <%= campaignData[i].campaignName %>
                        </option>
                        <% } %>
                    </select>
                </div>
                <div class="col-sm-2 my-1">
                    <select class="custom-select mr-sm-2" name="campaignPay" id="mode">
                        <option value="null" selected> Mode </option>
                        <% for(let i = 0; i < campaignData.length; i++) {if(campaignData[i].descriptionMode != undefined) %>
                        <option value="<%= campaignData[i].descriptionMode %>"> <%= campaignData[i].descriptionMode %>
                        </option>
                        <% } %>
                    </select>
                </div>
                <div class="col-sm-2 my-1">
                    <select class="custom-select mr-sm-2" name="landingPoint" id="geo">
                        <option value="null" selected>Geo</option>
                        <% for(let i = 0; i < campaignData.length; i++) { if(campaignData[i].geo != undefined) {%>
                        <option value="<%= campaignData[i].geo %>"> <%= campaignData[i].geo %> </option>
                        <% } } %>
                    </select>
                </div>
                <div class="col-sm-2 my-1">

                    <select class="custom-select mr-sm-2" name="landingPoint" id="vertical">
                        <option value="null" selected>Vertical</option>
                        <% for(let i = 0; i < campaignData.length; i++) { if(campaignData[i].vertical != undefined) { %>
                        <option value="<%= campaignData[i].vertical %>"> <%= campaignData[i].vertical %> </option>
                        <% }} %>

                    </select>
                </div>
                <div class="col-auto my-2">
                    <button type="submit" class="btn btn-dark" onclick="submit();">Submit</button>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="row py-2 table-responsive-lg">
            <table class="table">
                <thead class="thead-light">
                    <tr>
                        <th scope="col">Advertiser Name</th>
                        <th scope="col">Campaign Name</th>
                        <th scope="col">Description</th>
                        <th scope="col">campaignPay</th>
                        <th scope="col">landingPoint</th>
                        <th scope="col">Geo Loc</th>
                        <th scope="col">Geo Vertical</th>
                    </tr>
                </thead>
                <tbody id="tbody">

                </tbody>
            </table>
        </div>
    </div>
</body>
<script>
    function submit() {
        var requestData = {}
        requestData.advertiser = document.getElementById('Advertiser').value;
        requestData.campaign = document.getElementById('campaign').value;
        requestData.mode = document.getElementById('mode').value;
        requestData.geo = document.getElementById('geo').value;
        requestData.vertical = document.getElementById('vertical').value;
        console.log(requestData);
        var request = new XMLHttpRequest();
        var url = "/campaign/filter";
        request.open("POST", url, false);
        request.setRequestHeader("Content-Type", "application/json");
        request.onreadystatechange = function () {
            if (request.readyState === 4 && request.status === 200) {
                result = JSON.parse(request.responseText);
                console.log(result);
                document.getElementById('tbody').innerHTML = "";
                result.forEach(row => {
                    //console.log(row);
                    let code = `<tr>
                        <td> ${row.advertiserName}</td>
                        <td>${row.campaignName}</td>
                        <td>${row.descriptionMode}</td>
                        <td>${row.campaignPay}</td>
                        <td>${row.landingPoint}</td>
                        <td>${row.geo}</td>
                        <td>${row.vertical}</td>
                    </tr>`;
                    //console.log(code);
                    document.getElementById('tbody').innerHTML += code;
                });
            }
        };

        request.send(JSON.stringify(requestData));
    }

</script>

</html>